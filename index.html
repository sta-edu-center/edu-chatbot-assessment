<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SW Testing Foundation êµìœ¡ ì´ìˆ˜ì í‰ê°€</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f6f7fb;
}
.container {
  max-width: 900px;
  margin: 30px auto;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,.08);
  overflow: hidden;
}
.header {
  padding: 16px 20px;
  border-bottom: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.title { font-weight: 800; }
#adminBtn {
  display: none;
  border: none;
  background: transparent;
  font-size: 18px;
  cursor: pointer;
  opacity: .6;
}
#adminBtn:hover { opacity: 1; }

.chat {
  height: 420px;
  overflow-y: auto;
  padding: 20px;
  background: #fafafa;
}
.msg { margin-bottom: 12px; display: flex; }
.msg.bot { justify-content: flex-start; }
.msg.user { justify-content: flex-end; }

.bubble {
  max-width: 75%;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid #e5e7eb;
  background: #f1f5f9;
  white-space: pre-line;
  font-size: 14px;
}

/* ê²°ê³¼ ë§í’ì„  */
.bubble.result { font-weight: 700; }
.bubble.result.pass {
  background: #ecfdf5;
  border-color: #22c55e;
  color: #065f46;
}
.bubble.result.fail {
  background: #fef2f2;
  border-color: #ef4444;
  color: #7f1d1d;
}

.footer {
  padding: 16px 20px;
  border-top: 1px solid #e5e7eb;
  display: flex;
  gap: 10px;
  align-items: center;
}

select, button {
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #e5e7eb;
  font-size: 14px;
}
button {
  background: #2563eb;
  color: #fff;
  font-weight: 700;
  border: none;
  cursor: pointer;
}
button:disabled {
  opacity: .5;
  cursor: not-allowed;
}
</style>
</head>

<body>
<div class="container">
  <div class="header">
    <div class="title">êµìœ¡ ì´ìˆ˜ í‰ê°€</div>
    <button id="adminBtn" title="ê´€ë¦¬ì ì„¤ì •">âš™ï¸</button>
  </div>

  <div id="chat" class="chat"></div>

  <!-- êµìœ¡ìƒ ì…ë ¥ ì˜ì—­ -->
  <div class="footer">
    <select id="examMonth">
      <option value="">ì‘ì‹œì›” ì„ íƒ</option>
    </select>
    <button id="startBtn">í‰ê°€ ì‹œì‘</button>
  </div>
</div>

<script>
/* admin=true ì¼ ë•Œë§Œ ì•„ì´ì½˜ */
const params = new URLSearchParams(location.search);
if (params.get("admin") === "true") {
  document.getElementById("adminBtn").style.display = "inline-block";
}

/* ===== ì±„íŒ… ===== */
const chat = document.getElementById("chat");
function addBubble(text, role = "bot") {
  const msg = document.createElement("div");
  msg.className = "msg " + role;
  const bubble = document.createElement("div");
  bubble.className = "bubble";
  bubble.innerText = text;
  msg.appendChild(bubble);
  chat.appendChild(msg);
  chat.scrollTop = chat.scrollHeight;
  return bubble;
}

/* ===== ì‘ì‹œì›” ë“œë¡­ë‹¤ìš´ ìƒì„± (ìµœê·¼ 12ê°œì›”) ===== */
const examMonthSelect = document.getElementById("examMonth");

(function populateMonths() {
  const now = new Date();
  for (let i = 0; i < 12; i++) {
    const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
    const y = d.getFullYear();
    const m = String(d.getMonth() + 1).padStart(2, "0");
    const value = `${y}-${m}`;
    const opt = document.createElement("option");
    opt.value = value;
    opt.textContent = value;
    examMonthSelect.appendChild(opt);
  }
})();

/* ===== ì‹œì‘ ===== */
document.getElementById("startBtn").addEventListener("click", () => {
  const examMonth = examMonthSelect.value;
  if (!examMonth) {
    alert("ì‘ì‹œì›”ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }
  addBubble(`ì‘ì‹œì›”: ${examMonth}\ní‰ê°€ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤ ğŸ“˜`, "bot");

  // âš ï¸ ì—¬ê¸°ì„œ ë¬¸ì œ ì¶œì œ ë¡œì§ ì‹œì‘í•˜ë©´ ë¨
  setTimeout(finishTest, 800); // ì˜ˆì‹œ
});

/* ===== ì¢…ë£Œ (ì˜ˆì‹œ) ===== */
function finishTest() {
  const score = 75;
  const passScore = 70;
  const pass = score >= passScore;

  addBubble("ëª¨ë“  ë¬¸í•­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ âœ…", "bot");

  const bubble = addBubble(
    `ì´ì : ${score}ì \nê²°ê³¼: ${pass ? "PASS" : "FAIL"}\n(ê¸°ì¤€: ${passScore}ì  ì´ìƒ Pass)`,
    "bot"
  );

  bubble.classList.add("result", pass ? "pass" : "fail");

  addBubble("ì‘ë‹µì„ ì €ì¥ ì¤‘ì…ë‹ˆë‹¤â€¦", "bot");
}

/* ì´ˆê¸° ë©”ì‹œì§€ */
addBubble("ì•ˆë…•í•˜ì„¸ìš”! ì‘ì‹œì›”ì„ ì„ íƒí•˜ê³  í‰ê°€ë¥¼ ì‹œì‘í•´ì£¼ì„¸ìš” ğŸ˜Š", "bot");
</script>
</body>
</html>
